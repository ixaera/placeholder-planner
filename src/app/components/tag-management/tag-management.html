<div (click)="stopPropagation($event)" class="bg-white border-4 border-violet-500 rounded-lg shadow-xl p-6">
  <h2 class="text-3xl font-bold text-violet-950 mb-6 pb-3 border-b-2 border-violet-200">
    Tag Management
  </h2>

  <div class="grid grid-cols-5 gap-6">
    <!-- Left Panel: Add New Tag (1 column = 20%) -->
    <div class="col-span-1 border-r-2 border-violet-200 pr-6">
      <h3 class="text-xl font-semibold text-indigo-900 mb-4">Add New Tag</h3>

      <div (click)="stopPropagation($event)" class="space-y-3">
        <input
          type="text"
          [(ngModel)]="newTagInput"
          (keyup.enter)="createTag()"
          [maxlength]="15"
          placeholder="Enter tag name..."
          class="w-full px-4 py-3 border-2 border-violet-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-base"
        />
        <p class="text-xs text-violet-600">{{ newTagInput.length }}/15 characters</p>
        <button
          (click)="createTag()"
          class="w-full px-4 py-3 bg-violet-600 hover:bg-violet-700 text-white font-semibold rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
          Create Tag
        </button>
      </div>
    </div>

    <!-- Right Panel: Tag List (4 columns = 80%) -->
    <div class="col-span-4">
      <h3 class="text-xl font-semibold text-indigo-900 mb-4">All Tags</h3>

      @if (tags.length === 0) {
        <div class="text-center py-12 text-violet-600">
          <p class="text-lg">No tags yet. Add tags to your goals or create them here!</p>
        </div>
      } @else {
        <div (click)="stopPropagation($event)" class="grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3">
          @for (tag of tags; track tag) {
            <div>
              <!-- Display Mode -->
              @if (editingTag !== tag) {
                <div class="inline-flex items-center gap-2 px-4 py-2 bg-violet-200 text-violet-900 rounded-full text-sm font-medium hover:bg-violet-300 transition-colors duration-200">
                  <span>{{ tag }}</span>
                  <button
                    (click)="startEditTag(tag, $event)"
                    class="hover:bg-violet-400 rounded-full p-1 transition-colors duration-200"
                    title="Edit tag">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                    </svg>
                  </button>
                </div>
              }

              <!-- Edit Mode -->
              @if (editingTag === tag) {
                <div (click)="stopPropagation($event)" class="flex items-center gap-1">
                  <input
                    type="text"
                    [(ngModel)]="editTagInput[tag]"
                    (keyup.enter)="saveTagEdit(tag)"
                    (keyup.escape)="cancelEdit()"
                    (blur)="saveTagEdit(tag)"
                    [maxlength]="15"
                    class="flex-1 px-3 py-1 border-2 border-violet-500 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-violet-600"
                    autofocus
                  />
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
